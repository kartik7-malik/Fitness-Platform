{"ast":null,"code":"var _jsxFileName = \"/Users/kartikmalik/Guvi project/fitness-platform/client/src/context/AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\n\n// Create a custom hook to use the auth context\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [currentUser, setCurrentUser] = useState(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    // Check if user is logged in\n    const token = localStorage.getItem('token');\n    if (token) {\n      try {\n        // Verify token expiration\n        const decodedToken = jwt_decode(token);\n        const currentTime = Date.now() / 1000;\n        if (decodedToken.exp < currentTime) {\n          // Token expired\n          logout();\n        } else {\n          // Set auth token header\n          axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n          // Get current user\n          getCurrentUser();\n        }\n      } catch (err) {\n        console.error('Invalid token', err);\n        logout();\n      }\n    } else {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Register user\n  const register = async userData => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const res = await axios.post('/api/auth/register', userData);\n\n      // Set token to localStorage\n      localStorage.setItem('token', res.data.token);\n\n      // Set auth token header\n      axios.defaults.headers.common['Authorization'] = `Bearer ${res.data.token}`;\n\n      // Set current user\n      setCurrentUser(res.data.user);\n      setIsAuthenticated(true);\n      toast.success('Registration successful!');\n      return res.data.user;\n    } catch (err) {\n      var _err$response, _err$response$data, _err$response2, _err$response2$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Registration failed');\n      toast.error(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || 'Registration failed');\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Login user\n  const login = async (email, password) => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const res = await axios.post('/api/auth/login', {\n        email,\n        password\n      });\n\n      // Set token to localStorage\n      localStorage.setItem('token', res.data.token);\n\n      // Set auth token header\n      axios.defaults.headers.common['Authorization'] = `Bearer ${res.data.token}`;\n\n      // Set current user\n      setCurrentUser(res.data.user);\n      setIsAuthenticated(true);\n      toast.success('Login successful!');\n      return res.data.user;\n    } catch (err) {\n      var _err$response3, _err$response3$data, _err$response4, _err$response4$data;\n      setError(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || 'Login failed');\n      toast.error(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.message) || 'Login failed');\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Logout user\n  const logout = () => {\n    // Remove token from localStorage\n    localStorage.removeItem('token');\n\n    // Remove auth header\n    delete axios.defaults.headers.common['Authorization'];\n\n    // Reset state\n    setCurrentUser(null);\n    setIsAuthenticated(false);\n    setError(null);\n    toast.info('You have been logged out');\n  };\n\n  // Get current user\n  const getCurrentUser = async () => {\n    setIsLoading(true);\n    try {\n      const res = await axios.get('/api/auth/me');\n      setCurrentUser(res.data.data.user);\n      setIsAuthenticated(true);\n    } catch (err) {\n      console.error('Error fetching current user', err);\n      logout();\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Update user profile\n  const updateProfile = async userData => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const res = await axios.patch('/api/auth/updateMe', userData);\n      setCurrentUser(res.data.data.user);\n      toast.success('Profile updated successfully!');\n      return res.data.data.user;\n    } catch (err) {\n      var _err$response5, _err$response5$data, _err$response6, _err$response6$data;\n      setError(((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : (_err$response5$data = _err$response5.data) === null || _err$response5$data === void 0 ? void 0 : _err$response5$data.message) || 'Failed to update profile');\n      toast.error(((_err$response6 = err.response) === null || _err$response6 === void 0 ? void 0 : (_err$response6$data = _err$response6.data) === null || _err$response6$data === void 0 ? void 0 : _err$response6$data.message) || 'Failed to update profile');\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      currentUser,\n      isAuthenticated,\n      isLoading,\n      error,\n      register,\n      login,\n      logout,\n      updateProfile\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 160,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"wqEmplMsYKH23brZAJ7co9rLtvM=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","axios","jwt_decode","toast","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","context","Error","AuthProvider","children","_s2","currentUser","setCurrentUser","isAuthenticated","setIsAuthenticated","isLoading","setIsLoading","error","setError","token","localStorage","getItem","decodedToken","currentTime","Date","now","exp","logout","defaults","headers","common","getCurrentUser","err","console","register","userData","res","post","setItem","data","user","success","_err$response","_err$response$data","_err$response2","_err$response2$data","response","message","login","email","password","_err$response3","_err$response3$data","_err$response4","_err$response4$data","removeItem","info","get","updateProfile","patch","_err$response5","_err$response5$data","_err$response6","_err$response6$data","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/kartikmalik/Guvi project/fitness-platform/client/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport { toast } from 'react-toastify';\n\nexport const AuthContext = createContext();\n\n// Create a custom hook to use the auth context\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    // Check if user is logged in\n    const token = localStorage.getItem('token');\n    if (token) {\n      try {\n        // Verify token expiration\n        const decodedToken = jwt_decode(token);\n        const currentTime = Date.now() / 1000;\n        \n        if (decodedToken.exp < currentTime) {\n          // Token expired\n          logout();\n        } else {\n          // Set auth token header\n          axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n          // Get current user\n          getCurrentUser();\n        }\n      } catch (err) {\n        console.error('Invalid token', err);\n        logout();\n      }\n    } else {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Register user\n  const register = async (userData) => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const res = await axios.post('/api/auth/register', userData);\n      \n      // Set token to localStorage\n      localStorage.setItem('token', res.data.token);\n      \n      // Set auth token header\n      axios.defaults.headers.common['Authorization'] = `Bearer ${res.data.token}`;\n      \n      // Set current user\n      setCurrentUser(res.data.user);\n      setIsAuthenticated(true);\n      toast.success('Registration successful!');\n      \n      return res.data.user;\n    } catch (err) {\n      setError(err.response?.data?.message || 'Registration failed');\n      toast.error(err.response?.data?.message || 'Registration failed');\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Login user\n  const login = async (email, password) => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const res = await axios.post('/api/auth/login', { email, password });\n      \n      // Set token to localStorage\n      localStorage.setItem('token', res.data.token);\n      \n      // Set auth token header\n      axios.defaults.headers.common['Authorization'] = `Bearer ${res.data.token}`;\n      \n      // Set current user\n      setCurrentUser(res.data.user);\n      setIsAuthenticated(true);\n      toast.success('Login successful!');\n      \n      return res.data.user;\n    } catch (err) {\n      setError(err.response?.data?.message || 'Login failed');\n      toast.error(err.response?.data?.message || 'Login failed');\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Logout user\n  const logout = () => {\n    // Remove token from localStorage\n    localStorage.removeItem('token');\n    \n    // Remove auth header\n    delete axios.defaults.headers.common['Authorization'];\n    \n    // Reset state\n    setCurrentUser(null);\n    setIsAuthenticated(false);\n    setError(null);\n    \n    toast.info('You have been logged out');\n  };\n\n  // Get current user\n  const getCurrentUser = async () => {\n    setIsLoading(true);\n    \n    try {\n      const res = await axios.get('/api/auth/me');\n      setCurrentUser(res.data.data.user);\n      setIsAuthenticated(true);\n    } catch (err) {\n      console.error('Error fetching current user', err);\n      logout();\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Update user profile\n  const updateProfile = async (userData) => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const res = await axios.patch('/api/auth/updateMe', userData);\n      setCurrentUser(res.data.data.user);\n      toast.success('Profile updated successfully!');\n      return res.data.data.user;\n    } catch (err) {\n      setError(err.response?.data?.message || 'Failed to update profile');\n      toast.error(err.response?.data?.message || 'Failed to update profile');\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        currentUser,\n        isAuthenticated,\n        isLoading,\n        error,\n        register,\n        login,\n        logout,\n        updateProfile\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAC7E,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,UAAU,MAAM,YAAY;AACnC,SAASC,KAAK,QAAQ,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEvC,OAAO,MAAMC,WAAW,gBAAGT,aAAa,CAAC,CAAC;;AAE1C;AACA,OAAO,MAAMU,OAAO,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAMC,OAAO,GAAGT,UAAU,CAACM,WAAW,CAAC;EACvC,IAAI,CAACG,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CAAC,6CAA6C,CAAC;EAChE;EACA,OAAOD,OAAO;AAChB,CAAC;AAACD,EAAA,CANWD,OAAO;AAQpB,OAAO,MAAMI,YAAY,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,GAAA;EAC5C,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAACkB,eAAe,EAAEC,kBAAkB,CAAC,GAAGnB,QAAQ,CAAC,KAAK,CAAC;EAC7D,MAAM,CAACoB,SAAS,EAAEC,YAAY,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACsB,KAAK,EAAEC,QAAQ,CAAC,GAAGvB,QAAQ,CAAC,IAAI,CAAC;EAExCC,SAAS,CAAC,MAAM;IACd;IACA,MAAMuB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAIF,KAAK,EAAE;MACT,IAAI;QACF;QACA,MAAMG,YAAY,GAAGvB,UAAU,CAACoB,KAAK,CAAC;QACtC,MAAMI,WAAW,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI;QAErC,IAAIH,YAAY,CAACI,GAAG,GAAGH,WAAW,EAAE;UAClC;UACAI,MAAM,CAAC,CAAC;QACV,CAAC,MAAM;UACL;UACA7B,KAAK,CAAC8B,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUX,KAAK,EAAE;UAClE;UACAY,cAAc,CAAC,CAAC;QAClB;MACF,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZC,OAAO,CAAChB,KAAK,CAAC,eAAe,EAAEe,GAAG,CAAC;QACnCL,MAAM,CAAC,CAAC;MACV;IACF,CAAC,MAAM;MACLX,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMkB,QAAQ,GAAG,MAAOC,QAAQ,IAAK;IACnCnB,YAAY,CAAC,IAAI,CAAC;IAClBE,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,MAAMkB,GAAG,GAAG,MAAMtC,KAAK,CAACuC,IAAI,CAAC,oBAAoB,EAAEF,QAAQ,CAAC;;MAE5D;MACAf,YAAY,CAACkB,OAAO,CAAC,OAAO,EAAEF,GAAG,CAACG,IAAI,CAACpB,KAAK,CAAC;;MAE7C;MACArB,KAAK,CAAC8B,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUM,GAAG,CAACG,IAAI,CAACpB,KAAK,EAAE;;MAE3E;MACAP,cAAc,CAACwB,GAAG,CAACG,IAAI,CAACC,IAAI,CAAC;MAC7B1B,kBAAkB,CAAC,IAAI,CAAC;MACxBd,KAAK,CAACyC,OAAO,CAAC,0BAA0B,CAAC;MAEzC,OAAOL,GAAG,CAACG,IAAI,CAACC,IAAI;IACtB,CAAC,CAAC,OAAOR,GAAG,EAAE;MAAA,IAAAU,aAAA,EAAAC,kBAAA,EAAAC,cAAA,EAAAC,mBAAA;MACZ3B,QAAQ,CAAC,EAAAwB,aAAA,GAAAV,GAAG,CAACc,QAAQ,cAAAJ,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcH,IAAI,cAAAI,kBAAA,uBAAlBA,kBAAA,CAAoBI,OAAO,KAAI,qBAAqB,CAAC;MAC9D/C,KAAK,CAACiB,KAAK,CAAC,EAAA2B,cAAA,GAAAZ,GAAG,CAACc,QAAQ,cAAAF,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcL,IAAI,cAAAM,mBAAA,uBAAlBA,mBAAA,CAAoBE,OAAO,KAAI,qBAAqB,CAAC;MACjE,MAAMf,GAAG;IACX,CAAC,SAAS;MACRhB,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;;EAED;EACA,MAAMgC,KAAK,GAAG,MAAAA,CAAOC,KAAK,EAAEC,QAAQ,KAAK;IACvClC,YAAY,CAAC,IAAI,CAAC;IAClBE,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,MAAMkB,GAAG,GAAG,MAAMtC,KAAK,CAACuC,IAAI,CAAC,iBAAiB,EAAE;QAAEY,KAAK;QAAEC;MAAS,CAAC,CAAC;;MAEpE;MACA9B,YAAY,CAACkB,OAAO,CAAC,OAAO,EAAEF,GAAG,CAACG,IAAI,CAACpB,KAAK,CAAC;;MAE7C;MACArB,KAAK,CAAC8B,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUM,GAAG,CAACG,IAAI,CAACpB,KAAK,EAAE;;MAE3E;MACAP,cAAc,CAACwB,GAAG,CAACG,IAAI,CAACC,IAAI,CAAC;MAC7B1B,kBAAkB,CAAC,IAAI,CAAC;MACxBd,KAAK,CAACyC,OAAO,CAAC,mBAAmB,CAAC;MAElC,OAAOL,GAAG,CAACG,IAAI,CAACC,IAAI;IACtB,CAAC,CAAC,OAAOR,GAAG,EAAE;MAAA,IAAAmB,cAAA,EAAAC,mBAAA,EAAAC,cAAA,EAAAC,mBAAA;MACZpC,QAAQ,CAAC,EAAAiC,cAAA,GAAAnB,GAAG,CAACc,QAAQ,cAAAK,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcZ,IAAI,cAAAa,mBAAA,uBAAlBA,mBAAA,CAAoBL,OAAO,KAAI,cAAc,CAAC;MACvD/C,KAAK,CAACiB,KAAK,CAAC,EAAAoC,cAAA,GAAArB,GAAG,CAACc,QAAQ,cAAAO,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcd,IAAI,cAAAe,mBAAA,uBAAlBA,mBAAA,CAAoBP,OAAO,KAAI,cAAc,CAAC;MAC1D,MAAMf,GAAG;IACX,CAAC,SAAS;MACRhB,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;;EAED;EACA,MAAMW,MAAM,GAAGA,CAAA,KAAM;IACnB;IACAP,YAAY,CAACmC,UAAU,CAAC,OAAO,CAAC;;IAEhC;IACA,OAAOzD,KAAK,CAAC8B,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC;;IAErD;IACAlB,cAAc,CAAC,IAAI,CAAC;IACpBE,kBAAkB,CAAC,KAAK,CAAC;IACzBI,QAAQ,CAAC,IAAI,CAAC;IAEdlB,KAAK,CAACwD,IAAI,CAAC,0BAA0B,CAAC;EACxC,CAAC;;EAED;EACA,MAAMzB,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjCf,YAAY,CAAC,IAAI,CAAC;IAElB,IAAI;MACF,MAAMoB,GAAG,GAAG,MAAMtC,KAAK,CAAC2D,GAAG,CAAC,cAAc,CAAC;MAC3C7C,cAAc,CAACwB,GAAG,CAACG,IAAI,CAACA,IAAI,CAACC,IAAI,CAAC;MAClC1B,kBAAkB,CAAC,IAAI,CAAC;IAC1B,CAAC,CAAC,OAAOkB,GAAG,EAAE;MACZC,OAAO,CAAChB,KAAK,CAAC,6BAA6B,EAAEe,GAAG,CAAC;MACjDL,MAAM,CAAC,CAAC;IACV,CAAC,SAAS;MACRX,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;;EAED;EACA,MAAM0C,aAAa,GAAG,MAAOvB,QAAQ,IAAK;IACxCnB,YAAY,CAAC,IAAI,CAAC;IAClBE,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,MAAMkB,GAAG,GAAG,MAAMtC,KAAK,CAAC6D,KAAK,CAAC,oBAAoB,EAAExB,QAAQ,CAAC;MAC7DvB,cAAc,CAACwB,GAAG,CAACG,IAAI,CAACA,IAAI,CAACC,IAAI,CAAC;MAClCxC,KAAK,CAACyC,OAAO,CAAC,+BAA+B,CAAC;MAC9C,OAAOL,GAAG,CAACG,IAAI,CAACA,IAAI,CAACC,IAAI;IAC3B,CAAC,CAAC,OAAOR,GAAG,EAAE;MAAA,IAAA4B,cAAA,EAAAC,mBAAA,EAAAC,cAAA,EAAAC,mBAAA;MACZ7C,QAAQ,CAAC,EAAA0C,cAAA,GAAA5B,GAAG,CAACc,QAAQ,cAAAc,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcrB,IAAI,cAAAsB,mBAAA,uBAAlBA,mBAAA,CAAoBd,OAAO,KAAI,0BAA0B,CAAC;MACnE/C,KAAK,CAACiB,KAAK,CAAC,EAAA6C,cAAA,GAAA9B,GAAG,CAACc,QAAQ,cAAAgB,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcvB,IAAI,cAAAwB,mBAAA,uBAAlBA,mBAAA,CAAoBhB,OAAO,KAAI,0BAA0B,CAAC;MACtE,MAAMf,GAAG;IACX,CAAC,SAAS;MACRhB,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAED,oBACEd,OAAA,CAACC,WAAW,CAAC6D,QAAQ;IACnBC,KAAK,EAAE;MACLtD,WAAW;MACXE,eAAe;MACfE,SAAS;MACTE,KAAK;MACLiB,QAAQ;MACRc,KAAK;MACLrB,MAAM;MACN+B;IACF,CAAE;IAAAjD,QAAA,EAEDA;EAAQ;IAAAyD,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACW,CAAC;AAE3B,CAAC;AAAC3D,GAAA,CA9JWF,YAAY;AAAA8D,EAAA,GAAZ9D,YAAY;AAAA,IAAA8D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}